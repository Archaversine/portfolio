<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Adam Brohl - Simulating Prisoner’s Dilemma Strategies with Haskell</title>
        <link rel="stylesheet" href="../css/default.css" />
        <link rel="stylesheet" href="../css/syntax.css" />
        
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">Adam Brohl</a>
            </div>
            <nav>
                <a href="../">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <a href="../archive.html">Archive</a>
            </nav>
        </header>

        <main role="main">
            <h1>Simulating Prisoner’s Dilemma Strategies with Haskell</h1>
            <article>
    <section class="header">
        Posted on February 23, 2023
        
            by Adam Brohl
        
    </section>
    <section>
        <p>There are several different strategies that one could use to approach a
prisoner’s dilemma-type situation, here are four of the many that will be explored:</p>
<ol type="1">
<li><strong>Always Cooperating</strong>: Always choosing to cooperate with the opponent no matter what their past actions were.</li>
<li><strong>Always Defecting</strong>: Always choosing to defect towards the opponent no matter what their past actions were.</li>
<li><strong>Grim Trigger</strong>: Cooperating with the opponent until the opponent defects. Once the opponent defects, always defect towards the opponent.</li>
<li><strong>Tit for Tat</strong>: Begin by cooperating with the opponent, after that copy the opponent’s last action.</li>
</ol>
<p>To begin laying the groundwork for these situations, we need two main things:</p>
<ol type="1">
<li><strong>Strategy Type</strong>: For the different strategies to be simulated</li>
<li><strong>Choice Type</strong>: For the different possible choices each player can make.</li>
</ol>
<p>Each of these are defined below:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> <span class="dt">Strategy</span> <span class="ot">=</span> <span class="dt">AlwaysCooperate</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">AlwaysDefect</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">GrimTrigger</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">|</span> <span class="dt">TitForTat</span> <span class="kw">deriving</span> <span class="dt">Show</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> <span class="dt">Choice</span> <span class="ot">=</span> <span class="dt">Cooperate</span> <span class="op">|</span> <span class="dt">Defect</span> <span class="kw">deriving</span> (<span class="dt">Eq</span>, <span class="dt">Show</span>)</span></code></pre></div>
<h2 id="defining-strategies">Defining Strategies</h2>
<p>The way a player makes a decision with a given strategy must be defined.
When making a decision, information of the opponent’s previous moves should
also be taken into account, to allow for strategies like <code>GrimTrigger</code> and <code>TitForTat</code>.</p>
<p>Below is a function <code>getStrategyChoice</code> that returns a player’s choice utilizing
a specific strategy. This function takes in the player’s strategy and a list
of the all the opponents previous moves (the first element is the most recent move made):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ot">getStrategyChoice ::</span> <span class="dt">Strategy</span> <span class="ot">-&gt;</span> [<span class="dt">Choice</span>] <span class="ot">-&gt;</span> <span class="dt">Choice</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>getStrategyChoice <span class="dt">AlwaysCooperate</span> _ <span class="ot">=</span> <span class="dt">Cooperate</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>getStrategyChoice <span class="dt">AlwaysDefect</span>    _ <span class="ot">=</span> <span class="dt">Defect</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>getStrategyChoice <span class="dt">GrimTrigger</span> opponentOutcomes</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">|</span> <span class="dt">Defect</span> <span class="ot">`elem`</span> opponentOutcomes <span class="ot">=</span> <span class="dt">Defect</span>    <span class="co">-- If opponent has defected in the past</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">|</span> <span class="fu">otherwise</span>                      <span class="ot">=</span> <span class="dt">Cooperate</span> <span class="co">-- If the opponent has never defected</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>getStrategyChoice <span class="dt">TitForTat</span> opponentOutcomes</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">|</span> <span class="fu">null</span> opponentOutcomes <span class="ot">=</span> <span class="dt">Cooperate</span>             <span class="co">-- If opponent hasn't moved yet cooperate</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">|</span> <span class="fu">otherwise</span>             <span class="ot">=</span> <span class="fu">head</span> opponentOutcomes <span class="co">-- Play opponent's most recent move</span></span></code></pre></div>
<h2 id="calculating-rewards">Calculating Rewards</h2>
<p>In the prisoner’s dilemma, players get a higher reward if they both cooperate
than if they both defect. However, both players have an incentive to defect
since if one player cooperates and the other defects, the one that defects
gets a higher reward than if they both cooperated. The rewards for each outcome
can be shown with the following table:</p>
<table>
<thead>
<tr>
<th></th>
<th>P2 Cooperates</th>
<th>P2 Defects</th>
</tr>
</thead>
<tbody>
<tr>
<td>P1 Cooperates</td>
<td>P1: 10, P2: 10</td>
<td>P1: 0, P2: 15</td>
</tr>
<tr>
<td>P1 Defects</td>
<td>P1: 15, P2: 0</td>
<td>P1: 5, P2: 5</td>
</tr>
</tbody>
</table>
<p>Below is a function <code>getOutcomeRewards</code> that takes in two <code>Choice</code> types from each
player and returns a tuple of rewards (Ex: (0, 15)) where the first value is
the payoff for player one and the second value is the payoff for player two:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ot">getOutcomeRewards ::</span> <span class="dt">Choice</span> <span class="ot">-&gt;</span> <span class="dt">Choice</span> <span class="ot">-&gt;</span> (<span class="dt">Int</span>, <span class="dt">Int</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>getOutcomeRewards <span class="dt">Cooperate</span> <span class="dt">Cooperate</span> <span class="ot">=</span> (<span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>getOutcomeRewards <span class="dt">Cooperate</span> <span class="dt">Defect</span>    <span class="ot">=</span> (<span class="dv">0</span>, <span class="dv">15</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>getOutcomeRewards <span class="dt">Defect</span>    <span class="dt">Cooperate</span> <span class="ot">=</span> (<span class="dv">15</span>, <span class="dv">0</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>getOutcomeRewards <span class="dt">Defect</span>    <span class="dt">Defect</span>    <span class="ot">=</span> (<span class="dv">5</span>, <span class="dv">5</span>)</span></code></pre></div>
<h2 id="simulating-strategies">Simulating Strategies</h2>
<p>All the groundwork for strategies and choices has been finished, now we need a
way to simulate the payoffs each strategy gets. A function <code>simulateStrategies</code>
will be defined below that takes in two strategies, and a number for how many
iterations to run them against each other. This function will then return a
list of tuples where each tuple has the <code>Strategy</code> and payoffs of that strategy
in the simulation. For example, simulating two <code>AlwaysDefect</code> strategies against
each other for 10 iterations would yield the result <code>[(AlwaysDefect, 50), (AlwaysDefect, 50)]</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ot">simulateStrategies ::</span> <span class="dt">Strategy</span> <span class="ot">-&gt;</span> <span class="dt">Strategy</span> <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> [(<span class="dt">Strategy</span>, <span class="dt">Int</span>)]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>simulateStrategies s1 s2 n <span class="ot">=</span> simulateStrategies' s1 s2 n [] (<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span> simulateStrategies' s1 s2 <span class="dv">0</span> outcomes (r1, r2) <span class="ot">=</span> [(s1, r1), (s2, r2)]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        simulateStrategies' s1 s2 n outcomes (r1, r2) <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>          <span class="kw">let</span> choice1 <span class="ot">=</span> getStrategyChoice s1 (<span class="fu">map</span> <span class="fu">snd</span> outcomes)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>              choice2 <span class="ot">=</span> getStrategyChoice s2 (<span class="fu">map</span> <span class="fu">fst</span> outcomes)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>              outcome <span class="ot">=</span> (choice1, choice2)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>              rewards <span class="ot">=</span> getOutcomeRewards choice1 choice2</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>          simulateStrategies' s1 s2 (n <span class="op">-</span> <span class="dv">1</span>) (outcome <span class="op">:</span> outcomes) (<span class="fu">fst</span> rewards <span class="op">+</span> r1, <span class="fu">snd</span> rewards <span class="op">+</span> r2)</span></code></pre></div>
<h2 id="comparing-strategies">Comparing Strategies</h2>
<p>Now that <code>simulateStrategies</code> exists, it is now possible to compare strategies
with each other. For example, to compare the <code>AlwaysCooperate</code> with the
<code>AlwaysDefect</code> strategy, <code>simulateStrategies AlwaysCooperate AlwaysDefect 100</code> will
return the payoffs for both strategies after 100 iterations.</p>
<p>Below is the code to test each strategy with each other
(there are duplicates, but for the sake of simplicity they are left in):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Comparing AlwaysCooperate</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">AlwaysCooperate</span> <span class="dt">AlwaysCooperate</span> <span class="dv">100</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">AlwaysCooperate</span> <span class="dt">AlwaysDefect</span> <span class="dv">100</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">AlwaysCooperate</span> <span class="dt">GrimTrigger</span> <span class="dv">100</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">AlwaysCooperate</span> <span class="dt">TitForTat</span> <span class="dv">100</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">-- Comparing AlwaysDefect</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">AlwaysDefect</span> <span class="dt">AlwaysCooperate</span> <span class="dv">100</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">AlwaysDefect</span> <span class="dt">AlwaysDefect</span> <span class="dv">100</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">AlwaysDefect</span> <span class="dt">GrimTrigger</span> <span class="dv">100</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">AlwaysDefect</span> <span class="dt">TitForTat</span> <span class="dv">100</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">-- Comparing GrimTrigger</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">GrimTrigger</span> <span class="dt">AlwaysCooperate</span> <span class="dv">100</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">GrimTrigger</span> <span class="dt">AlwaysDefect</span> <span class="dv">100</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">GrimTrigger</span> <span class="dt">GrimTrigger</span> <span class="dv">100</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">GrimTrigger</span> <span class="dt">TitForTat</span> <span class="dv">100</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">-- Comparing TitForTat</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">TitForTat</span> <span class="dt">AlwaysCooperate</span> <span class="dv">100</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">TitForTat</span> <span class="dt">AlwaysDefect</span> <span class="dv">100</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">TitForTat</span> <span class="dt">GrimTrigger</span> <span class="dv">100</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span> <span class="op">$</span> simulateStrategies <span class="dt">TitForTat</span> <span class="dt">TitForTat</span> <span class="dv">100</span></span></code></pre></div>
<h2 id="final-results">Final Results</h2>
<p>After comparing all the strategies with each other, we can see the payoffs
for each strategy against each strategy:</p>
    </section>
</article>

        </main>

        <footer>
            Site <em>proudly</em> generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
